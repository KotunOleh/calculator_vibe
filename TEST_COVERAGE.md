# Тестування та покриття коду

## Огляд

Цей проект містить всеосяжний набір модульних тестів за допомогою фреймворку `unittest` Python з покриттям коду **94%**.

### Статистика покриття:
- **route.py**: 93% покриття
- **route_builder.py**: 92% покриття  
- **ticket.py**: 97% покриття
- **ВСЬОГО**: 94% покриття

## Встановлення залежностей

```bash
python3 -m pip install coverage
```

## Запуск тестів

### З вимірюванням покриття (рекомендовано):
```bash
python3 run_tests.py
```

Це запустить:
1. Усі тести з детальним виводом
2. Обчислить покриття коду для всіх модулів
3. Згенерує HTML звіт у папці `htmlcov`

### Без вимірювання покриття:
```bash
python3 run_tests.py --simple
```

або

```bash
python3 -m unittest discover -p 'test_*.py' -v
```

## Перегляд детального звіту

Після запуску тестів з покриттям, відкрийте HTML звіт:
```bash
open htmlcov/index.html
```

## Структура тестів

### test_route.py
Тести для модуля `route.py`:
- **TestRoute**: 9 тестів основної функціональності Route
- **TestRouteWithFloatDuration**: 1 тест для роботи з дробовими числами

**Охопленні сценарії:**
- Ініціалізація маршруту
- Розрахунок ціни та тривалості
- Побудова списку міст
- Обробка порожних маршрутів
- Вивід інформації про маршрут

### test_route_builder.py
Тести для модуля `route_builder.py`:
- **TestCheapestRouteStrategy**: 4 тести пошуку найдешевшого маршруту
- **TestFastestRouteStrategy**: 3 тести пошуку найшвидшого маршруту
- **TestFewestStopsStrategy**: 4 тести пошуку з найменшою кількістю пересадок
- **TestRouteManager**: 5 тестів менеджера маршрутів

**Охопленні сценарії:**
- Пошук прямих маршрутів
- Пошук непрямих (через інші міста) маршрутів
- Обробка випадків без маршруту
- Тестування всіх трьох стратегій пошуку
- Вибір стратегії на основі типу пошуку

### test_ticket.py
Тести для модуля `ticket.py`:
- **TestSimpleTicket**: 5 тестів простого квитка
- **TestBaggageDecorator**: 4 тести декоратора багажу
- **TestInsuranceDecorator**: 3 тести декоратора страхування
- **TestPriorityBoardingDecorator**: 3 тести декоратора пріоритету
- **TestMultipleDecorators**: 3 тести комбінацій декораторів
- **TestTicketManager**: 6 тестів менеджера квитків

**Охопленні сценарії:**
- Базова функціональність квитків
- Розрахунок ціни з кожним добавком
- Опис квитка з додатками
- Комбінування декораторів
- Менеджер для автоматичного створення квитків
- Користувацькі ціни для додатків

## Кількість тестів

- **Всього тестів**: 50
- **Всі пройдені**: ✓

## Результати покриття

```
Name               Stmts   Miss  Cover
--------------------------------------
route.py              29      2    93%
route_builder.py     116      9    92%
ticket.py             68      2    97%
--------------------------------------
TOTAL                213     13    94%
```

## Пояснення покриття

### Не покриті лінії коду

**route.py (2 рядки, 7%):**
- Вивід інформації про транспорт для типів, що не визначені в тестових даних

**route_builder.py (9 рядків, 8%):**
- Видання повідомлення про помилку при відсутності маршруту через ValueError
- Деякі граничні випадки в обробці графів

**ticket.py (2 рядки, 3%):**
- Видання debug інформації в TicketManager (print для багажу/страхування)

## Примітки

- Тести повністю перевіряють основну функціональність всіх модулів
- Використовуються юніт-тести для ізоляції функціональності
- Тести охоплюють як позитивні, так і негативні випадки
- Тестування декораторів перевіряє правильність паттерну Decorator

## Версія Python

Тести розроблені для Python 3.9+. Синтаксис type hints використовує `Union[float, int]` замість `float | int` для максимальної сумісності.

## Автоматизація

Для запуску тестів як частини CI/CD pipeline:
```bash
python3 run_tests.py && echo "Coverage check passed!"
```

Це повернуть 0 для успіху і 1 для невдачі.
